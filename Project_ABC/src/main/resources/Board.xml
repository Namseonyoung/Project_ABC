<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="Board">	
	<resultMap type="Board" id="boardResult">
	    <!-- tb_board 테이블의 
	    조회결과에서
	    어떤 컬럼의 값이 어떤 속성에 저장되야 하는지 설정
	     -->
	     <result property="num" column="num" />
	     <result property="title" column="title" />
	     <result property="content" column="content" />
	     <result property="filename" column="filename" />
	     <result property="realfilename" column="realfilename" />
	</resultMap>
    <!-- 
      tb_board 테이블에서 num이 일치하는 레코드 조회
      실행할쿼리
       select num,title,content,filename
       from tb_board where num=#{num}      
     -->		
	<select id="selectBoard" resultMap="boardResult">
		<![CDATA[
			select num,title,content,filename,realfilename
			from tb_board where num=#{num}
		]]>
	</select>
  <!-- 
      tb_board 테이블에서 모든 레코드 조회
      실행할쿼리
       select num,title,content,filename
       from tb_board  
     -->
	<select id="selectBoardList" resultMap="boardResult" >
		<![CDATA[
			select num,title,content,filename
			from tb_board  
		]]>
	</select>
 <!-- 
      tb_board 테이블에서 레코드 검색
      실행할쿼리
       select num,title,content,filename
       from tb_board  
       <where>
       <if test="title != null">
		title LIKE '%' || #{title} || '%'
	  </if>
        <if test="content != null">
		content LIKE '%' || #{content} || '%'
	  </if>
	  <if test="filename != null">
		filename LIKE '%' || #{filename} || '%'
	  </if>
       </where>
     -->
	<select id="searchBoardList" 
	     parameterType="Board" resultMap="boardResult">
		select num,title,content,filename
       from tb_board  
       <where>
       <if test="title != null">
		title LIKE '%' || #{title} || '%'
	  </if>
        <if test="content != null">
		content LIKE '%' || #{content} || '%'
	  </if>
	  <if test="filename != null">
		filename LIKE '%' || #{filename} || '%'
	  </if>
       </where>
	</select>
	<!-- 
      tb_board 테이블에서 레코드 검색해서 조건에 일치하는 레코드의 수를 리턴
      실행할쿼리
       select count(*)
       from tb_board  
       <where>
       <if test="title != null">
		title LIKE '%' || #{title} || '%'
	  </if>
        <if test="content != null">
		content LIKE '%' || #{content} || '%'
	  </if>
	  <if test="filename != null">
		filename LIKE '%' || #{filename} || '%'
	  </if>
       </where>
     -->
	<select id="searchBoardCount" 	
	     parameterType="Board" resultType="int">
		select count(*)
		from tb_board  
		<where>
			<if test="title != null">
				title LIKE '%' || #{title} || '%'
			</if>
			<if test="content != null">
				content LIKE '%' || #{content} || '%'
			</if>
			<if test="filename != null">
				filename LIKE '%' || #{filename} || '%'
			</if>
		</where>
	</select>
	<select id="selectBoardCount" resultType="int">
	    select count(*) from tb_board
	</select>
	<insert id="insertBoard" parameterType="Board">
		<selectKey resultType="string" keyProperty="num" order="BEFORE">
			SELECT board_seq.nextval from dual 
		</selectKey>
		insert into tb_board (num,title,content,filename,realfilename)
		values (#{num},#{title},#{content},#{filename},#{realfilename})
	</insert>
	
</mapper>













